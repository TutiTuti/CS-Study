# CORS란 ?
Cross-Origin Resoure Sharing은 출처가 다른 자원들을 공유한다는 뜻으로, 한 출처에 있는 자원에서   
다른 출처에 있는 자원에 접근하도록 하는 개념입니다.    
CORS는 추가 HTTP 헤더를 사용하며, 한 출처에서 실행 중인 웹 애플리케이션이 다른 출처의 접근할 수 있는    
권한을 부여하도록 브라우저에 알려주는 체제입니다.    
웹 에플리케이션은 리소스가 자신의 출처와 다를 때 교차 출처 HTTP요청을 실행합니다.
### 출처란 ?
![img1 daumcdn](https://github.com/kj-cs-study/CS-Study/assets/37789623/bfcb55a2-91e1-4f61-b4ad-a606a6ca71fd)
위에서 Protocol , Host, Port 3가지가 같으면 동일 출처라고 합니다.

## Same-Origin Policy / SOP
SOP란 동일한 출처에 대한 청책을 말한다. '동일한 출처에서만 리소스를 공유할 수 있다' 라는 법률을 가지고 있다.   
즉, 동일 출처 서버에 있는 리소스는 자유롭게 가져오지만, 다른출처 서버에 있는 이미지나 영상 같은 리소스는 상호작용이 불가능 하다는 말이다.
### 다른 출처 요청의 위험성
만일 제약이 없다면, 해커가 CSRF나 XSS등의 방법을 이용해서 우리가 만든 어플리케이션에서 해커가 심허놓은 코드가 실행하여   
개인 정보를 가로챌 수 있다.
### CORS를 사용하는 이유
SOP정책을 위반해도 CORS정책을 따르면 다른 출처의 리소스라도 허용하기 때문

## CORS 동작
### 1. 클라이언트에서 HTTP요청의 헤더에 Origin을 담아 전달
기본적으로 웹은 HTTP 프로토콜을 이용하여 서버에 요청을 보내게 되는데,    
이때 브라우저는 요청 헤더에 Origin 이라는 필드에 출처를 함께 담아 보내게 된다.    
### 2. 서버는 응답헤더에 Access-Control-Allow-Origin을 담아 클라이언트로 전달한다.
이후 서버가 이 요청에 대한 응답을 할 때 응답 헤더에 Access-Control-Allow-Origin이라는 필드를 추가하고 값으로   
'이 리소스를 접근하는 것이 허용된 출처 url'을 내려보낸다.
###  3. 클라이언트에서 Origin과 서버가 보내준 Access-Control-Allow-Origin을 비교한다.
이후 응답을 받은 브라우저는 자신이 보냈던 요청의 Origin과 서버가 보내준 응답의 Access-Control-Allow-Origin을    
비교해본 후 차단할지 말지를 결정한다.   
만약 유효하지 않다면 그 응답을 사용하지 않고 버린다. (CORS 에러 !!)    
위의 경우에는 둘다 http://localhost:3000이기 때문에 유효하니 다른 출처의 리소스를 문제없이 가져오게 된다.    
### 결국 CORS는 서버의 허용이 필요
위의 브라우저의 CORS 동작 과정을 살펴보니, 길고 길었던 여정의 결론은 서버에서 Access-Control-Allow-Origin 헤더에 허용할 출처를 기재해서 클라이언트에 응답하면 되는 것이었다. 즉, 백엔드 개발자가 고쳐야될 부분인 것이다.
